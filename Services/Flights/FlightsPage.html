<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Flight Results - GoTrip</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
      /* Basic reset & layout + refined palette & typography */
      :root {
        --accent: #1ea1ff; /* primary action blue */
        --accent-600: #1098f0;
        --muted: #6b7280;
        --card: #fbfdff; /* very light off-white for cards */
        --bg: #f4f7fa;
        --surface: #ffffff;
        --footer: #0f1a2b;
        --footer-ink: #dbe3f5;
      }
      * {
        box-sizing: border-box;
      }
      body {
        font-family: Inter, system-ui, "Segoe UI", Roboto, Arial;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        margin: 0;
        background: var(--bg);
        color: #0f1720;
      }
      .wrap {
        max-width: 1200px;
        margin: 22px auto;
        padding: 12px;
      }
      /* header with subtle brand gradient (blue tint) */
      header.summary {
        background: linear-gradient(
            180deg,
            rgba(30, 161, 255, 0.06),
            rgba(250, 251, fe, 0.02)
          ),
          var(--surface);
        border-radius: 12px;
        padding: 16px 20px;
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        align-items: center;
        box-shadow: 0 8px 28px rgba(15, 23, 42, 0.06);
      }
      .route {
        font-weight: 700;
        font-size: 18px;
      }
      .route .hdr-city {
        display: inline-block;
        vertical-align: middle;
      }
      .route .route-arrow {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin: 0 10px;
        vertical-align: middle;
        color: var(--muted);
      }
      .dates {
        color: var(--muted);
        margin-left: auto;
      }
      .cols {
        display: flex;
        gap: 16px;
        margin-top: 16px;
      }
      nav.filters {
        width: 300px;
        background: var(--surface);
        border-radius: 12px;
        padding: 16px;
        box-shadow: 0 8px 24px rgba(15, 23, 42, 0.04);
        position: sticky;
        top: 18px;
        align-self: flex-start;
        height: fit-content;
        max-height: calc(100vh - 100px);
        overflow-y: auto;
      }
      section.results {
        flex: 1;
      }
      .toolbar {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 12px;
      }
      .tabs {
        display: flex;
        background: #fff;
        border-radius: 8px;
        padding: 6px;
        gap: 8px;
      }
      .tab {
        padding: 8px 12px;
        border-radius: 6px;
        cursor: pointer;
        color: var(--muted);
        background: transparent;
      }
      .tab.active {
        background: linear-gradient(90deg, var(--accent), #3bb0ff);
        color: #fff;
        font-weight: 700;
      }
      .stats {
        margin-left: auto;
        color: var(--muted);
      }
      /* flight list */
      .list {
        display: flex;
        flex-direction: column;
        gap: 14px;
      }
      .card {
        display: flex;
        align-items: center;
        gap: 16px;
        background: var(--card);
        border-radius: 12px;
        padding: 16px;
        border: 1px solid rgba(14, 20, 24, 0.04);
      }
      .card.recommended {
        box-shadow: 0 10px 28px rgba(30, 161, 255, 0.06);
        border: 1px solid rgba(30, 161, 255, 0.12);
        background: linear-gradient(
          180deg,
          rgba(30, 161, 255, 0.02),
          var(--card)
        );
      }
      /* hover: make ticket slightly bigger without pushing layout (uses transform) */
      .card {
        transition: transform 0.16s cubic-bezier(0.2, 0.9, 0.2, 1),
          box-shadow 0.18s;
        will-change: transform;
      }
      .card:hover {
        transform: scale(1.03);
        box-shadow: 0 12px 30px rgba(17, 24, 39, 0.08);
        z-index: 5;
      }
      /* avoid hover scaling on touch devices */
      @media (hover: none), (max-width: 940px) {
        .card:hover {
          transform: none;
          box-shadow: 0 6px 18px rgba(17, 24, 39, 0.04);
          z-index: auto;
        }
      }
      .airline {
        width: 110px;
        text-align: center;
        flex-shrink: 0;
      }
      .airline img {
        width: 64px;
        height: 64px;
        object-fit: contain;
      }
      .times {
        display: flex;
        gap: 18px;
        align-items: center;
        flex: 1;
      }
      .time {
        min-width: 120px;
      }
      .time .t {
        font-weight: 800;
        font-size: 20px;
      }
      .meta {
        color: var(--muted);
        font-size: 13px;
        margin-top: 6px;
      }
      .time-center {
        min-width: 90px;
        text-align: center;
        color: var(--muted);
        font-size: 13px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
      }
      .route-line {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--muted);
        font-size: 13px;
      }
      .stops {
        color: #334155;
        font-size: 13px;
        margin-top: 6px;
      }
      .badge {
        display: inline-block;
        padding: 6px 10px;
        border-radius: 999px;
        font-size: 12px;
        color: #b06a00;
        background: #fff;
        border: 1px solid #ffe8bf;
        margin-left: 8px;
      }
      .duration-pill {
        display: inline-block;
        padding: 6px 8px;
        border-radius: 8px;
        background: rgba(30, 161, 255, 0.06);
        color: var(--accent);
        font-weight: 700;
        font-size: 13px;
      }
      .stops-pill {
        display: inline-block;
        padding: 6px 8px;
        border-radius: 8px;
        background: #f1f5f9;
        color: #0f1720;
        font-size: 13px;
      }
      .priceCol {
        width: 200px;
        text-align: right;
        flex-shrink: 0;
      }
      .price {
        font-weight: 600;
        font-size: 22px;
        color: #071133;
      }
      .selectBtn {
        margin-top: 8px;
        background: var(--accent);
        color: #fff;
        border: 0;
        padding: 8px 14px;
        border-radius: 10px;
        cursor: pointer;
        box-shadow: 0 8px 20px rgba(30, 161, 255, 0.08);
      }
      /* small screens */
      @media (max-width: 940px) {
        .cols {
          flex-direction: column;
        }
        nav.filters {
          width: 100%;
        }
        .priceCol {
          width: 140px;
        }
      }
      .topbar {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
        padding: 10px 12px;
        margin-bottom: 18px;
        position: sticky;
        top: 0;
        z-index: 50;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 18px;
        max-width: 100%;
      }
      /* brand / logo (replaced top-left structure */
      .brand-wrap {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .brand-link {
        display: flex;
        align-items: center;
        gap: 12px;
        text-decoration: none;
      }
      .brand-badge {
        width: 56px;
        height: 56px;
        border-radius: 12px;
        background: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 8px 24px rgba(2, 6, 23, 0.06);
        flex-shrink: 0;
      }
      .brand-badge img {
        width: 40px;
        height: 40px;
        object-fit: contain;
        display: block;
      }
      .brand-title {
        color: #fff;
        padding: 0;
        font-weight: 800;
        font-size: 20px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }
      .brand-title small {
        font-weight: 600;
        opacity: 0.95;
      }

      /* site navigation */
      .site-nav {
        display: flex;
        align-items: center;
        gap: 18px;
      }
      .site-nav ul {
        display: flex;
        align-items: center;
        gap: 12px;
        margin: 0;
        padding: 0;
        list-style: none;
      }
      .site-nav .nav-left .nav-link {
        padding: 8px 6px;
        color: #fff;
        text-decoration: none;
        border-radius: 6px;
        transition: all 0.2s;
      }
      .site-nav .nav-left .nav-link.active {
        color: #fff;
        font-weight: 800;
        border-bottom: 3px solid #fff;
        padding-bottom: 6px;
      }
      /* hover style (desktop) */
      @media (hover: hover) and (pointer: fine) {
        .site-nav .nav-left .nav-link:hover {
          color: #fff;
          font-weight: 800;
          border-bottom: 3px solid #fff;
          padding-bottom: 6px;
        }
      }
      .site-nav .muted {
        color: #6b7280;
        font-weight: 700;
      }

      /* right controls */
      .nav-right .small {
        color: #fff;
        text-decoration: none;
        padding: 0 6px;
        font-size: 14px;
        transition: all 0.2s;
      }
      .nav-right .flag {
        font-size: 16px;
      }
      .signin-btn {
        background: #fff;
        border: 1px solid #fff;
        color: #007bff;
        padding: 6px 12px;
        border-radius: 20px;
        cursor: pointer;
        transition: all 0.2s;
        font-weight: 600;
        text-decoration: none;
        display: inline-block;
      }
      .login-btn {
        background: transparent;
        border: 1px solid #fff;
        color: #fff;
        padding: 6px 12px;
        border-radius: 20px;
        cursor: pointer;
        transition: all 0.2s;
        text-decoration: none;
        display: inline-block;
      }

      /* hover / selected style for right-side items and login button */
      .nav-right .small:hover,
      .nav-right .flag:hover,
      .nav-right .small.active,
      .nav-right .flag.active {
        color: #fff;
        font-weight: 800;
        background: rgba(255, 255, 255, 0.15);
        padding: 4px 8px;
        border-radius: 6px;
      }
      .signin-btn:hover,
      .signin-btn.active {
        background: #f0f8ff;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }
      .login-btn:hover,
      .login-btn.active {
        border-color: #fff;
        color: #fff;
        background: rgba(255, 255, 255, 0.15);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      /* currency dropdown styling */
      .cur-dropdown {
        position: relative;
      }
      .cur-dropdown .cur-btn {
        background: transparent;
        border: 0;
        padding: 0 6px;
        font-size: 14px;
        cursor: pointer;
        color: #fff;
        transition: all 0.2s;
      }
      .cur-dropdown .cur-menu {
        position: absolute;
        right: 0;
        top: calc(100% + 8px);
        min-width: 180px;
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(17, 24, 39, 0.08);
        padding: 6px 0;
        display: none;
        list-style: none;
        margin: 0;
        border: 1px solid #eef2f7;
        z-index: 60;
      }
      .cur-dropdown .cur-menu .cur-item {
        padding: 8px 12px;
        cursor: pointer;
        color: #222;
        font-size: 14px;
      }
      .cur-dropdown .cur-menu .cur-item:hover {
        background: rgba(30, 161, 255, 0.06);
        color: var(--accent);
        font-weight: 700;
      }
      /* language dropdown styling (mirrors currency) */
      .lang-dropdown {
        position: relative;
      }
      .lang-dropdown .lang-btn {
        background: transparent;
        border: 0;
        padding: 0 6px;
        font-size: 14px;
        cursor: pointer;
        color: #fff;
        transition: all 0.2s;
      }
      .lang-dropdown .lang-menu {
        position: absolute;
        right: 0;
        top: calc(100% + 8px);
        min-width: 180px;
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(17, 24, 39, 0.08);
        padding: 6px 0;
        display: none;
        list-style: none;
        margin: 0;
        border: 1px solid #eef2f7;
        z-index: 70;
      }
      .lang-dropdown .lang-menu .lang-item {
        padding: 8px 12px;
        cursor: pointer;
        color: #222;
        font-size: 14px;
      }
      .lang-dropdown .lang-menu .lang-item:hover {
        background: rgba(30, 161, 255, 0.06);
        color: var(--accent);
        font-weight: 700;
      }
      /* show on hover for pointer devices */
      @media (hover: hover) and (pointer: fine) {
        .cur-dropdown:hover .cur-menu {
          display: block;
        }
        .lang-dropdown:hover .lang-menu {
          display: block;
        }
      }
      /* small screens / touch: toggle via .open */
      .cur-dropdown.open .cur-menu {
        display: block;
      }
      .lang-dropdown.open .lang-menu {
        display: block;
      }
      /* filters small icons */
      .filters svg {
        width: 14px;
        height: 14px;
        vertical-align: middle;
        margin-right: 8px;
        opacity: 0.7;
      }
      /* custom checkbox styling */
      .filters input[type="checkbox"] {
        appearance: none;
        width: 18px;
        height: 18px;
        border: 2px solid #d1d5db;
        border-radius: 4px;
        margin-right: 8px;
        cursor: pointer;
        position: relative;
        vertical-align: middle;
        transition: all 0.2s;
      }
      .filters input[type="checkbox"]:hover {
        border-color: var(--accent);
      }
      .filters input[type="checkbox"]:checked {
        background: var(--accent);
        border-color: var(--accent);
      }
      .filters input[type="checkbox"]:checked::after {
        content: '✓';
        position: absolute;
        color: white;
        font-size: 14px;
        font-weight: bold;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }
      .filters label {
        cursor: pointer;
        user-select: none;
      }
      /* price range track cosmetic */
      .price-range {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 10px;
      }
      .price-range .price-inputs {
        display: flex;
        gap: 8px;
      }
      .price-range input[type="range"] {
        width: 100%;
      }

      /* Footer styles */
      .site-footer {
        background: var(--footer);
        color: var(--footer-ink);
        margin-top: 40px;
      }
      .footer-grid {
        display: grid;
        grid-template-columns: 2fr 1fr 1fr 1fr;
        gap: 24px;
        padding: 28px 0;
        max-width: 1200px;
        margin: 0 auto;
      }
      .f-col h4 {
        color: #fff;
        margin-bottom: 12px;
        font-size: 16px;
      }
      .f-brand {
        font-weight: 900;
        font-size: 24px;
        color: #fff;
        margin-bottom: 8px;
      }
      .f-col .muted {
        color: var(--footer-ink);
        opacity: 0.8;
      }
      .f-links {
        list-style: none;
        padding: 0;
        margin: 8px 0 0 0;
        display: grid;
        gap: 6px;
      }
      .f-links a {
        color: var(--footer-ink);
        text-decoration: none;
        transition: all 0.2s;
      }
      .f-links a:hover {
        text-decoration: underline;
        color: #fff;
      }
      .footer-bottom {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px 0;
        border-top: 1px solid rgba(255, 255, 255, 0.08);
        max-width: 1200px;
        margin: 0 auto;
      }
      .footer-bottom .copy {
        color: var(--footer-ink);
      }
      .social a {
        display: inline-grid;
        place-items: center;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        border: 1px solid rgba(255, 255, 255, 0.25);
        color: #fff;
        text-decoration: none;
        margin-left: 6px;
        font-weight: 700;
        transition: all 0.2s;
      }
      .social a:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: rgba(255, 255, 255, 0.5);
      }
      @media (max-width: 940px) {
        .footer-grid {
          grid-template-columns: 1fr 1fr;
          padding: 20px 12px;
        }
        .footer-bottom {
          flex-direction: column;
          gap: 12px;
          padding: 16px 12px;
        }
      }
    </style>
  </head>
  <body>
    <!-- topbar with Home and GoTrip logo -->
    <div class="topbar">
      <!-- Home button (click -> homepage) and logo placeholder -->
      <div class="brand-wrap">
        <a
          id="homeBtn"
          class="brand-link"
          href="../../HomePage/HomePage.html"
          title="GoTrip home"
          aria-label="GoTrip home"
        >
          <span class="brand-badge" aria-hidden="true">
            <img
              id="siteLogoImg"
              src="../../HomePage/Photos/logo.jpg"
              alt="GoTrip logo"
              onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 48 48%22><rect rx=%229%22 width=%2248%22 height=%2248%22 fill=%22%23ffffff%22/><path d=%22M8 34v-6c0-5 6-9 14-9s14 4 14 9v6%22 stroke=%22%231ea1ff%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22 fill=%22none%22/></svg>'"
            />
          </span>
          <span class="brand-title">GoTrip</span>
        </a>
      </div>

      <!-- main navigation -->
      <nav class="site-nav" aria-label="main navigation">
        <ul class="nav-left">
          <li>
            <a class="nav-link active" href="#">Flights</a>
          </li>
          <li>
            <a class="nav-link" href="../Buses/BusesSearchResults.html"
              >Buses</a
            >
          </li>
          <li>
            <a class="nav-link" href="../Hotels/HotelsPage.html">Hotels</a>
          </li>
        </ul>

        <ul class="nav-right">
          <!-- language dropdown: hover on desktop, click to toggle on touch -->
          <li class="lang-dropdown" aria-haspopup="true">
            <button class="small lang-btn" type="button" aria-expanded="false">
              EN ▾
            </button>
            <ul class="lang-menu" role="menu" aria-label="Select language">
              <li class="lang-item" role="menuitem" data-value="EN">
                EN — English
              </li>
              <li class="lang-item" role="menuitem" data-value="AR">
                AR — العربية
              </li>
              <li class="lang-item" role="menuitem" data-value="FR">
                FR — Français
              </li>
              <li class="lang-item" role="menuitem" data-value="TR">
                TR — Türkçe
              </li>
              <li class="lang-item" role="menuitem" data-value="RU">
                RU — Русский
              </li>
            </ul>
          </li>
          <!-- currency dropdown: hover on desktop, click to toggle on touch -->
          <li class="cur-dropdown" aria-haspopup="true">
            <button class="small cur-btn" type="button" aria-expanded="false">
              SAR ▾
            </button>
            <ul class="cur-menu" role="menu" aria-label="Select currency">
              <li class="cur-item" role="menuitem" data-value="SAR">
                SAR — Saudi Riyal
              </li>
              <li class="cur-item" role="menuitem" data-value="USD">
                USD — US Dollar
              </li>
              <li class="cur-item" role="menuitem" data-value="EUR">
                EUR — Euro
              </li>
              <li class="cur-item" role="menuitem" data-value="AED">
                AED — UAE Dirham
              </li>
              <li class="cur-item" role="menuitem" data-value="GBP">
                GBP — British Pound
              </li>
            </ul>
          </li>
          <li><a class="small" href="#" id="supportLink">Support</a></li>
          <li><a class="small" href="#" id="myTripsLink">My Trips</a></li>
          <li>
            <a
              href="../../Login/signin.html"
              class="signin-btn"
              aria-label="Sign in"
            >
              Sign in
            </a>
          </li>
          <li>
            <a
              href="../../Login/login.html"
              class="login-btn"
              aria-label="Login"
            >
              Login
            </a>
          </li>
        </ul>
      </nav>
    </div>

    <div class="wrap">
      <header class="summary">
        <div>
          <div class="route" id="hdrRoute">Loading...</div>
          <div class="meta" id="hdrMeta">
            Searching flights — results from multiple providers
          </div>
        </div>
        <div class="dates" id="hdrDates">—</div>
      </header>

      <!-- Flight search bar matching HomePage design -->
      <section class="flight-search-section" aria-label="Quick flight search">
        <div class="search-container">
          <div class="tab-buttons">
            <button class="active" data-trip="round">Round-trip</button>
            <button data-trip="oneway">One-way</button>
            <button data-trip="multi">Multi-city</button>
          </div>

          <form id="flightSearchForm" class="grid-form" autocomplete="off">
            <div class="field">
              <label for="search_from">From</label>
              <input
                id="search_from"
                type="text"
                placeholder="City or Airport"
                value=""
              />
            </div>

            <div class="field">
              <label for="search_to">To</label>
              <input
                id="search_to"
                type="text"
                placeholder="City or Airport"
                value=""
              />
            </div>

            <div class="field">
              <label for="search_depart">Departure</label>
              <input
                id="search_depart"
                type="date"
                value=""
              />
            </div>

            <div class="field" id="returnField">
              <label for="search_return">Return</label>
              <input
                id="search_return"
                type="date"
                value=""
              />
            </div>

            <div class="field">
              <label for="search_pax">Passengers</label>
              <select id="search_pax">
                <option>1 Adult</option>
                <option>2 Adults</option>
                <option>3 Adults</option>
                <option>Family</option>
              </select>
            </div>

            <div class="field">
              <label for="search_cabin">Class</label>
              <select id="search_cabin">
                <option>Economy</option>
                <option>Premium Economy</option>
                <option>Business</option>
                <option>First Class</option>
              </select>
            </div>

            <label class="checkbox">
              <input type="checkbox" id="search_direct" value="true" />
              <span>Direct flights only</span>
            </label>

            <button class="search-btn" type="submit">Search</button>
          </form>
        </div>
      </section>

      <style>
        /* Flight search bar matching HomePage design */
        .flight-search-section {
          background: #fff;
          padding: 20px;
          border-radius: 12px;
          margin: 14px 0;
          box-shadow: 0 4px 18px rgba(15, 23, 42, 0.04);
        }
        .search-container {
          max-width: 1200px;
          margin: 0 auto;
        }
        .tab-buttons {
          display: flex;
          gap: 8px;
          margin: 0 0 16px;
        }
        .tab-buttons button {
          border: 1px solid #e3e8f4;
          background: #f7f9ff;
          color: #1a2742;
          padding: 8px 16px;
          border-radius: 10px;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.2s;
        }
        .tab-buttons button.active {
          background: var(--accent);
          color: #fff;
          border-color: var(--accent);
        }
        .grid-form {
          display: grid;
          grid-template-columns: repeat(6, 1fr);
          gap: 10px;
          width: 100%;
          box-sizing: border-box;
        }
        .field {
          display: flex;
          flex-direction: column;
          gap: 6px;
          min-width: 0;
          box-sizing: border-box;
        }
        .field label {
          color: var(--muted);
          font-size: 0.9rem;
          font-weight: 500;
        }
        .field input,
        .field select {
          height: 42px;
          border: 1px solid #d6deee;
          border-radius: 10px;
          padding: 0 12px;
          outline: none;
          background: #fff;
          width: 100%;
          box-sizing: border-box;
          min-width: 0;
          font-size: 14px;
        }
        .field input:focus,
        .field select:focus {
          border-color: var(--accent);
          box-shadow: 0 0 0 3px rgba(30, 161, 255, 0.1);
        }
        .checkbox {
          grid-column: span 2;
          display: flex;
          align-items: center;
          gap: 8px;
          color: #475069;
          cursor: pointer;
        }
        .checkbox input[type="checkbox"] {
          width: 16px;
          height: 16px;
          cursor: pointer;
          accent-color: var(--accent);
        }
        .search-btn {
          grid-column: 1 / -1;
          height: 44px;
          border-radius: 10px;
          border: 1px solid transparent;
          background: var(--accent);
          color: #fff;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.2s;
          font-size: 15px;
        }
        .search-btn:hover {
          background: var(--accent-600);
          transform: translateY(-1px);
          box-shadow: 0 4px 12px rgba(30, 161, 255, 0.3);
        }
        @media (max-width: 1000px) {
          .grid-form {
            grid-template-columns: 1fr;
          }
          .checkbox {
            grid-column: 1;
          }
        }
        @media (max-width: 768px) {
          .tab-buttons button {
            padding: 6px 12px;
            font-size: 13px;
          }
        }
      </style>

      <script>
        // ===== Flight Location Data =====
        const saudiLocations = [
          { code: 'RUH', city: 'Riyadh', name: 'King Khalid International Airport' },
          { code: 'JED', city: 'Jeddah', name: 'King Abdulaziz International Airport' },
          { code: 'DMM', city: 'Dammam', name: 'King Fahd International Airport' },
          { code: 'MED', city: 'Madinah', name: 'Prince Mohammad bin Abdulaziz Airport' },
          { code: 'TIF', city: 'Taif', name: 'Taif Regional Airport' },
          { code: 'AHB', city: 'Abha', name: 'Abha Regional Airport' },
          { code: 'GIZ', city: 'Jizan', name: 'Jizan Regional Airport' },
          { code: 'ELQ', city: 'Al Qassim', name: 'Gassim Regional Airport' },
          { code: 'TUU', city: 'Tabuk', name: 'Tabuk Regional Airport' },
          { code: 'AJF', city: 'Al Jouf', name: 'Al Jouf Domestic Airport' },
          { code: 'HOF', city: 'Al Ahsa', name: 'Al Ahsa Airport' },
          { code: 'URY', city: 'Gurayat', name: 'Gurayat Domestic Airport' },
          { code: 'RAH', city: 'Rafha', name: 'Rafha Domestic Airport' },
          { code: 'RAE', city: 'Arar', name: 'Arar Domestic Airport' },
          { code: 'AQI', city: 'Al Qaisumah', name: 'Al Qaisumah/Hafr Al Batin Airport' },
          { code: 'HAS', city: 'Hail', name: 'Hail Regional Airport' },
          { code: 'YNB', city: 'Yanbu', name: 'Yanbu Airport' },
          { code: 'WAE', city: 'Wadi Ad Dawasir', name: 'Wadi Al Dawasir Airport' },
          { code: 'EAM', city: 'Najran', name: 'Najran Domestic Airport' },
          { code: 'SHW', city: 'Sharurah', name: 'Sharurah Domestic Airport' },
          { code: 'ABT', city: 'Al Baha', name: 'Al Baha Domestic Airport' },
          { code: 'BHH', city: 'Bisha', name: 'Bisha Domestic Airport' },
          { code: 'DWD', city: 'Dawadmi', name: 'Dawadmi Domestic Airport' },
          { code: 'KMX', city: 'King Khalid Military City', name: 'King Khalid Military City Airport' }
        ];

        // Available flight routes
        const availableRoutes = [
          // From Riyadh (RUH)
          { from: 'RUH', to: 'JED' }, { from: 'RUH', to: 'DMM' }, { from: 'RUH', to: 'AHB' },
          { from: 'RUH', to: 'GIZ' }, { from: 'RUH', to: 'TUU' }, { from: 'RUH', to: 'HAS' },
          { from: 'RUH', to: 'EAM' }, { from: 'RUH', to: 'ELQ' }, { from: 'RUH', to: 'AJF' },
          { from: 'RUH', to: 'TIF' },
          // From Jeddah (JED)
          { from: 'JED', to: 'RUH' }, { from: 'JED', to: 'DMM' }, { from: 'JED', to: 'MED' },
          { from: 'JED', to: 'AHB' }, { from: 'JED', to: 'GIZ' }, { from: 'JED', to: 'TUU' },
          { from: 'JED', to: 'EAM' }, { from: 'JED', to: 'YNB' }, { from: 'JED', to: 'TIF' },
          // From Dammam (DMM)
          { from: 'DMM', to: 'RUH' }, { from: 'DMM', to: 'JED' }, { from: 'DMM', to: 'MED' },
          { from: 'DMM', to: 'AHB' }, { from: 'DMM', to: 'GIZ' }, { from: 'DMM', to: 'TUU' },
          { from: 'DMM', to: 'HAS' },
          // From Madinah (MED)
          { from: 'MED', to: 'RUH' }, { from: 'MED', to: 'JED' }, { from: 'MED', to: 'DMM' },
          { from: 'MED', to: 'AHB' }, { from: 'MED', to: 'GIZ' }, { from: 'MED', to: 'TUU' },
          // From Abha (AHB)
          { from: 'AHB', to: 'RUH' }, { from: 'AHB', to: 'JED' }, { from: 'AHB', to: 'DMM' },
          { from: 'AHB', to: 'GIZ' }, { from: 'AHB', to: 'EAM' },
          // From Jizan (GIZ)
          { from: 'GIZ', to: 'RUH' }, { from: 'GIZ', to: 'JED' }, { from: 'GIZ', to: 'DMM' },
          { from: 'GIZ', to: 'AHB' }, { from: 'GIZ', to: 'EAM' },
          // From Tabuk (TUU)
          { from: 'TUU', to: 'RUH' }, { from: 'TUU', to: 'JED' }, { from: 'TUU', to: 'DMM' },
          { from: 'TUU', to: 'MED' },
          // From Najran (EAM)
          { from: 'EAM', to: 'RUH' }, { from: 'EAM', to: 'JED' }, { from: 'EAM', to: 'AHB' },
          { from: 'EAM', to: 'GIZ' },
          // From Hail (HAS)
          { from: 'HAS', to: 'RUH' }, { from: 'HAS', to: 'JED' }, { from: 'HAS', to: 'DMM' },
          // From Al Qassim (ELQ)
          { from: 'ELQ', to: 'RUH' }, { from: 'ELQ', to: 'JED' }, { from: 'ELQ', to: 'DMM' },
          // From Taif (TIF)
          { from: 'TIF', to: 'RUH' }, { from: 'TIF', to: 'JED' }, { from: 'TIF', to: 'DMM' },
          // From Al Jouf (AJF)
          { from: 'AJF', to: 'RUH' }, { from: 'AJF', to: 'JED' },
          // From Yanbu (YNB)
          { from: 'YNB', to: 'RUH' }, { from: 'YNB', to: 'JED' }
        ];

        // Check if route exists
        function isRouteAvailable(fromCode, toCode) {
          return availableRoutes.some(route => 
            route.from === fromCode && route.to === toCode
          );
        }

        // Create autocomplete functionality
        function createAutocomplete(inputElement) {
          const container = inputElement.parentElement;
          const dropdown = document.createElement('div');
          dropdown.className = 'autocomplete-dropdown';
          dropdown.style.cssText = `
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #dfe6f3;
            border-top: none;
            border-radius: 0 0 10px 10px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: none;
          `;
          
          container.style.position = 'relative';
          container.appendChild(dropdown);
          
          let selectedLocation = null;
          
          inputElement.addEventListener('input', (e) => {
            const value = e.target.value.trim().toLowerCase();
            selectedLocation = null;
            
            if (value.length < 1) {
              dropdown.style.display = 'none';
              return;
            }
            
            // Filter locations
            const matches = saudiLocations.filter(loc => 
              loc.city.toLowerCase().includes(value) || 
              loc.code.toLowerCase().includes(value) ||
              loc.name.toLowerCase().includes(value)
            );
            
            if (matches.length === 0) {
              dropdown.style.display = 'none';
              return;
            }
            
            // Display matches
            dropdown.innerHTML = matches.map(loc => `
              <div class="autocomplete-item" data-code="${loc.code}" data-city="${loc.city}" style="
                padding: 12px;
                cursor: pointer;
                border-bottom: 1px solid #f0f0f0;
                transition: background 0.2s;
              " onmouseover="this.style.background='#f5f8ff'" onmouseout="this.style.background='white'">
                <div style="font-weight: 600; color: #0f1a2b;">${loc.city} (${loc.code})</div>
                <div style="font-size: 0.85rem; color: #7f8aa3;">${loc.name}</div>
              </div>
            `).join('');
            
            dropdown.style.display = 'block';
            
            // Handle item click
            dropdown.querySelectorAll('.autocomplete-item').forEach(item => {
              item.addEventListener('click', () => {
                const city = item.getAttribute('data-city');
                const code = item.getAttribute('data-code');
                selectedLocation = { city, code };
                inputElement.value = `${city} (${code})`;
                inputElement.setAttribute('data-location-code', code);
                inputElement.setAttribute('data-location-city', city);
                dropdown.style.display = 'none';
              });
            });
          });
          
          // Close dropdown on outside click
          document.addEventListener('click', (e) => {
            if (!container.contains(e.target)) {
              dropdown.style.display = 'none';
            }
          });
          
          // Validate on blur
          inputElement.addEventListener('blur', () => {
            setTimeout(() => {
              if (!selectedLocation && inputElement.value) {
                // Try to find exact match
                const exactMatch = saudiLocations.find(loc => 
                  inputElement.value.toLowerCase() === loc.city.toLowerCase() ||
                  inputElement.value.toLowerCase() === `${loc.city.toLowerCase()} (${loc.code.toLowerCase()})`
                );
                
                if (exactMatch) {
                  selectedLocation = { city: exactMatch.city, code: exactMatch.code };
                  inputElement.value = `${exactMatch.city} (${exactMatch.code})`;
                  inputElement.setAttribute('data-location-code', exactMatch.code);
                  inputElement.setAttribute('data-location-city', exactMatch.city);
                }
              }
            }, 200);
          });
          
          return dropdown;
        }

        // Initialize autocomplete
        const fromInput = document.getElementById('search_from');
        const toInput = document.getElementById('search_to');

        if (fromInput) {
          createAutocomplete(fromInput);
          fromInput.placeholder = 'Search city or airport...';
        }

        if (toInput) {
          createAutocomplete(toInput);
          toInput.placeholder = 'Search city or airport...';
        }

        // Tab switching functionality
        document.querySelectorAll(".tab-buttons button").forEach((btn) => {
          btn.addEventListener("click", () => {
            document.querySelectorAll(".tab-buttons button")
              .forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            
            const tripType = btn.dataset.trip;
            const returnField = document.getElementById("returnField");
            
            // Show/hide return field based on trip type
            if (tripType === "oneway") {
              returnField.style.display = "none";
            } else {
              returnField.style.display = "flex";
            }
          });
        });

        // Form submission with validation
        document.getElementById("flightSearchForm")?.addEventListener("submit", (e) => {
          e.preventDefault();
          
          const fromCode = fromInput.getAttribute('data-location-code');
          const toCode = toInput.getAttribute('data-location-code');
          
          // Validate locations selected
          if (!fromCode) {
            alert('⚠️ Please select your departure city from the list');
            fromInput.focus();
            return;
          }
          
          if (!toCode) {
            alert('⚠️ Please select your destination city from the list');
            toInput.focus();
            return;
          }
          
          if (fromCode === toCode) {
            alert('⚠️ Departure and destination must be different locations');
            toInput.focus();
            return;
          }
          
          // Check if route is available
          const routeAvailable = isRouteAvailable(fromCode, toCode);
          
          const params = new URLSearchParams();
          params.set("from", fromInput.getAttribute('data-location-city'));
          params.set("to", toInput.getAttribute('data-location-city'));
          params.set("fromCode", fromCode);
          params.set("toCode", toCode);
          params.set("routeAvailable", routeAvailable ? "true" : "false");
          params.set("departure", document.getElementById("search_depart").value || "");
          
          const returnDate = document.getElementById("search_return").value;
          if (returnDate && document.getElementById("returnField").style.display !== "none") {
            params.set("return", returnDate);
          }
          
          params.set("passengers", document.getElementById("search_pax").value || "1 Adult");
          params.set("class", document.getElementById("search_cabin").value || "Economy");
          
          if (document.getElementById("search_direct").checked) {
            params.set("direct", "true");
          }
          
          // Reload with new params
          window.location.search = params.toString();
        });

        // Pre-fill form with current URL parameters
        (function() {
          const params = new URLSearchParams(window.location.search);
          
          // Set location fields with codes if available
          const fromCity = params.get("from");
          const toCity = params.get("to");
          const fromCode = params.get("fromCode");
          const toCode = params.get("toCode");
          
          if (fromCity && fromCode) {
            fromInput.value = `${fromCity} (${fromCode})`;
            fromInput.setAttribute('data-location-code', fromCode);
            fromInput.setAttribute('data-location-city', fromCity);
          }
          
          if (toCity && toCode) {
            toInput.value = `${toCity} (${toCode})`;
            toInput.setAttribute('data-location-code', toCode);
            toInput.setAttribute('data-location-city', toCity);
          }
          
          if (params.get("departure")) document.getElementById("search_depart").value = params.get("departure");
          if (params.get("return")) document.getElementById("search_return").value = params.get("return");
          if (params.get("passengers")) document.getElementById("search_pax").value = params.get("passengers");
          if (params.get("class")) document.getElementById("search_cabin").value = params.get("class");
          if (params.get("direct")) document.getElementById("search_direct").checked = true;
        })();
      </script>

      <div class="cols">
        <nav class="filters" aria-label="Filters">
          <h4 style="margin: 0 0 8px 0">Filters</h4>
          <div style="font-size: 13px; color: var(--muted); margin-bottom: 8px">
            Stops
          </div>
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" data-filter="stops" value="0" />
            <svg
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
            >
              <path fill="currentColor" d="M3 12h18v2H3z" />
            </svg>
            Nonstop</label
          >
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" data-filter="stops" value="1" />
            <svg
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
            >
              <path fill="currentColor" d="M4 6h16v2H4z" />
            </svg>
            1 stop</label
          >
          <label style="display: block; margin-bottom: 12px"
            ><input type="checkbox" data-filter="stops" value="2+" />
            <svg
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
            >
              <path fill="currentColor" d="M4 12h16v2H4z" />
            </svg>
            2+ stops</label
          >

          <div style="font-size: 13px; color: var(--muted); margin: 12px 0 6px">
            Price range
          </div>
          <div class="price-range">
            <div class="price-inputs">
              <input
                id="priceMin"
                type="number"
                placeholder="Min"
                style="
                  width: 80px;
                  padding: 8px;
                  border-radius: 6px;
                  border: 1px solid #e6eef9;
                "
              />
              <input
                id="priceMax"
                type="number"
                placeholder="Max"
                style="
                  width: 80px;
                  padding: 8px;
                  border-radius: 6px;
                  border: 1px solid #e6eef9;
                "
              />
            </div>
            <input
              id="priceRange"
              type="range"
              min="0"
              max="2000"
              step="10"
              value="1000"
              style="width: 100%; accent-color: var(--accent);"
            />
          </div>
          <div style="display: flex; gap: 8px">
            <button
              id="applyFilters"
              style="
                flex: 1;
                padding: 10px;
                border-radius: 8px;
                border: 0;
                background: var(--accent);
                color: #fff;
              "
            >
              Apply
            </button>
            <button
              id="resetFilters"
              style="
                flex: 1;
                padding: 10px;
                border-radius: 8px;
                border: 1px solid #cfefff;
                background: #fff;
                color: var(--accent);
              "
            >
              Reset
            </button>
          </div>

          <hr
            style="margin: 14px 0; border: none; border-top: 1px solid #eef2f7"
          />

          <div style="font-size: 13px; color: var(--muted); margin-bottom: 8px">
            Booking options
          </div>
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" id="bookOnSite" /> Book on GoTrip</label
          >
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" id="noOvernight" /> No overnight
            flights</label
          >

          <hr
            style="margin: 14px 0; border: none; border-top: 1px solid #eef2f7"
          />

          <div style="font-size: 13px; color: var(--muted); margin-bottom: 8px">
            Airlines
          </div>
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" data-filter="airline" value="Saudia" /> Saudia</label
          >
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" data-filter="airline" value="flyadeal" /> flyadeal</label
          >
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" data-filter="airline" value="Flynas" /> Flynas</label
          >
          <label style="display: block; margin-bottom: 12px"
            ><input type="checkbox" data-filter="airline" value="BlueJet" /> BlueJet</label
          >

          <hr
            style="margin: 14px 0; border: none; border-top: 1px solid #eef2f7"
          />

          <div style="font-size: 13px; color: var(--muted); margin-bottom: 8px">
            Departure time
          </div>
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" data-filter="time" value="morning" /> 
            <svg viewBox="0 0 24 24" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 4px">
              <path fill="currentColor" d="M6 12c0-3.3 2.7-6 6-6s6 2.7 6 6-2.7 6-6 6-6-2.7-6-6zm6-8v2m0 12v2m8-8h-2M4 12H2m15.7-5.7L16.3 7.7M7.7 16.3l-1.4 1.4m0-11.4l1.4 1.4m8.6 8.6l1.4 1.4"/>
            </svg>
            Morning (5AM - 12PM)</label
          >
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" data-filter="time" value="afternoon" /> 
            <svg viewBox="0 0 24 24" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 4px">
              <path fill="currentColor" d="M12 6a6 6 0 100 12 6 6 0 000-12z"/>
            </svg>
            Afternoon (12PM - 6PM)</label
          >
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" data-filter="time" value="evening" /> 
            <svg viewBox="0 0 24 24" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 4px">
              <path fill="currentColor" d="M21 12.8A9 9 0 1111.2 3a7 7 0 009.8 9.8z"/>
            </svg>
            Evening (6PM - 12AM)</label
          >
          <label style="display: block; margin-bottom: 12px"
            ><input type="checkbox" data-filter="time" value="night" /> 
            <svg viewBox="0 0 24 24" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 4px">
              <path fill="currentColor" d="M21 12.8A9 9 0 1111.2 3a7 7 0 009.8 9.8z"/>
            </svg>
            Night (12AM - 5AM)</label
          >

          <hr
            style="margin: 14px 0; border: none; border-top: 1px solid #eef2f7"
          />

          <div style="font-size: 13px; color: var(--muted); margin-bottom: 8px">
            Flight duration
          </div>
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" data-filter="duration" value="short" /> Under 3 hours</label
          >
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" data-filter="duration" value="medium" /> 3-6 hours</label
          >
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" data-filter="duration" value="long" /> 6-12 hours</label
          >
          <label style="display: block; margin-bottom: 12px"
            ><input type="checkbox" data-filter="duration" value="verylong" /> Over 12 hours</label
          >

          <hr
            style="margin: 14px 0; border: none; border-top: 1px solid #eef2f7"
          />

          <div style="font-size: 13px; color: var(--muted); margin-bottom: 8px">
            Baggage
          </div>
          <label style="display: block; margin-bottom: 6px"
            ><input type="checkbox" id="carryOnOnly" /> Carry-on only</label
          >
          <label style="display: block; margin-bottom: 12px"
            ><input type="checkbox" id="checkedBag" /> Checked baggage included</label
          >
        </nav>

        <section class="results">
          <div class="toolbar">
            <div class="tabs" role="tablist">
              <div class="tab active" data-sort="recommended">Recommended</div>
              <div class="tab" data-sort="cheapest">Cheapest</div>
              <div class="tab" data-sort="fastest">Fastest</div>
            </div>
            <div class="stats" id="resultsCount">— results</div>
          </div>

          <div class="list" id="resultsList">
            <!-- cards injected here -->
          </div>
        </section>
      </div>
    </div>

    <script>
      // parse search params
      const params = new URLSearchParams(location.search);
      const from = params.get("from") || params.get("origin") || "Origin";
      const to = params.get("to") || params.get("destination") || "Destination";
      const depart =
        params.get("departure") || params.get("depart") || "Any date";
      const ret = params.get("return") || "";
      const pax = params.get("passengers") || "1 Adult";
      const cls = params.get("class") || "Economy";
      const routeAvailable = params.get("routeAvailable") === "true";

      // header
      document.getElementById("hdrRoute").textContent = `${from} → ${to}`;
      document.getElementById("hdrDates").textContent =
        `Depart: ${depart}` +
        (ret ? ` • Return: ${ret}` : "") +
        ` • ${pax} • ${cls}`;

      // demo dataset (extend or replace with real API)
      const sampleFlights = [
        {
          id: 1,
          airline: "Saudia",
          logo: "https://upload.wikimedia.org/wikipedia/en/thumb/4/48/Logo_of_Saudia.svg/1002px-Logo_of_Saudia.svg.png",
          dep: "15:40",
          arr: "01:10",
          duration: "8h 30m",
          stops: 1,
          via: "RUH",
          price: 509,
          offers: 12,
        },
        {
          id: 2,
          airline: "flyadeal",
          logo: "https://iconlogovector.com/uploads/images/2025/02/sm-67a940062feee-Flyadeal.webp",
          dep: "15:40",
          arr: "22:05",
          duration: "5h 25m",
          stops: 1,
          via: "RUH",
          price: 336,
          offers: 5,
          cheapest: true,
        },
        {
          id: 3,
          airline: "Saudia",
          logo: "https://upload.wikimedia.org/wikipedia/en/thumb/4/48/Logo_of_Saudia.svg/1002px-Logo_of_Saudia.svg.png",
          dep: "15:40",
          arr: "03:00",
          duration: "10h 20m",
          stops: 1,
          via: "RUH",
          price: 509,
        },
        {
          id: 4,
          airline: "Saudia",
          logo: "https://upload.wikimedia.org/wikipedia/en/thumb/4/48/Logo_of_Saudia.svg/1002px-Logo_of_Saudia.svg.png",
          dep: "19:55",
          arr: "09:45",
          duration: "12h 50m",
          stops: 2,
          via: "JED",
          price: 775,
        },
        {
          id: 5,
          airline: "Flynas",
          logo: "https://logowik.com/content/uploads/images/nas-air-flynas8667.jpg",
          dep: "08:00",
          arr: "11:10",
          duration: "3h 10m",
          stops: 0,
          via: "Nonstop",
          price: 599,
        },
        {
          id: 6,
          airline: "BlueJet",
          logo: "https://logos-world.net/wp-content/uploads/2023/02/JetBlue-Emblem.png",
          dep: "21:15",
          arr: "00:05",
          duration: "2h 50m",
          stops: 0,
          via: "Nonstop",
          price: 359,
        },
      ];

      let current = [...sampleFlights];

      const resultsList = document.getElementById("resultsList");
      const resultsCount = document.getElementById("resultsCount");

      function renderList(list) {
        resultsList.innerHTML = "";
        
        // Check if route is not available - show message
        if (!routeAvailable) {
          resultsList.innerHTML = `
            <div style="
              background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%);
              border: 2px solid #ffcccc;
              border-radius: 16px;
              padding: 40px;
              text-align: center;
              box-shadow: 0 8px 24px rgba(255, 100, 100, 0.1);
            ">
              <div style="font-size: 64px; margin-bottom: 16px;">✈️</div>
              <h2 style="color: #d32f2f; margin: 0 0 12px 0; font-size: 24px;">
                No Flights Available
              </h2>
              <p style="color: #666; font-size: 16px; margin: 0 0 8px 0;">
                Sorry, there are currently no direct flights from <strong>${from}</strong> to <strong>${to}</strong>.
              </p>
              <p style="color: #888; font-size: 14px; margin: 0 0 24px 0;">
                Please try searching for a different route or check back later.
              </p>
              <button onclick="window.location.href='../../HomePage/HomePage.html'" style="
                background: linear-gradient(90deg, #1ea1ff, #3bb0ff);
                color: white;
                border: none;
                padding: 12px 28px;
                border-radius: 10px;
                font-size: 16px;
                font-weight: 700;
                cursor: pointer;
                box-shadow: 0 4px 12px rgba(30, 161, 255, 0.3);
              ">
                ← Search New Flight
              </button>
            </div>
          `;
          resultsCount.textContent = "0 results";
          return;
        }
        
        // If no flights in filtered list
        if (list.length === 0) {
          resultsList.innerHTML = `
            <div style="
              background: #f8f9fa;
              border: 2px dashed #dee2e6;
              border-radius: 12px;
              padding: 40px;
              text-align: center;
            ">
              <div style="font-size: 48px; margin-bottom: 16px;">🔍</div>
              <h3 style="color: #495057; margin: 0 0 8px 0;">No flights match your filters</h3>
              <p style="color: #6c757d; margin: 0;">Try adjusting your search criteria</p>
            </div>
          `;
          resultsCount.textContent = "0 results";
          return;
        }
        
        resultsCount.textContent = `${list.length} results`;
        list.forEach((f) => {
          const card = document.createElement("div");
          // add recommended highlight for first item or flagged cheapest
          card.className =
            "card" +
            (f.recommended || f.cheapest || list.indexOf(f) === 0
              ? " recommended"
              : "");
          card.innerHTML = `
          <div class="airline">
            <img src="${f.logo}" alt="${
            f.airline
          } logo" onerror="this.src='https://via.placeholder.com/80x80?text=✈'">
            <div style="font-weight:700;margin-top:8px">${f.airline}</div>
          </div>
          <div class="times">
            <div class="time">
              <div class="t">${f.dep}</div>
              <div class="meta">${from}</div>
            </div>
            <div class="time-center">
              <div class="duration-pill">${f.duration}</div>
              <div class="route-arrow" aria-hidden="true">➜</div>
              <div class="stops-pill">${
                f.stops === 0
                  ? "Direct"
                  : f.stops + " stop" + (f.stops > 1 ? "s" : "")
              }</div>
            </div>
            <div class="time">
              <div class="t">${f.arr}</div>
              <div class="meta">${to}</div>
            </div>
          </div>
          <div class="priceCol">
            <div style="display:flex;justify-content:flex-end;align-items:center;gap:8px">
              ${
                f.cheapest
                  ? '<div class="badge">Cheapest</div>'
                  : f.offers
                  ? '<div class="badge">from ' + f.offers + " sites</div>"
                  : ""
              }
            </div>
            <div class="price">SAR ${f.price}</div>
            <button class="selectBtn" onclick="selectFlight(${
              f.id
            })">Select</button>
          </div>
        `;
          resultsList.appendChild(card);
        });
      }

      function selectFlight(id) {
        const f = sampleFlights.find((x) => x.id === id);
        alert(
          "Selected: " +
            f.airline +
            " • " +
            from +
            " → " +
            to +
            " • SAR " +
            f.price
        );
        // navigate to booking page when available
      }

      // sorting tabs
      document.querySelectorAll(".tab").forEach((t) => {
        t.addEventListener("click", () => {
          document
            .querySelectorAll(".tab")
            .forEach((x) => x.classList.remove("active"));
          t.classList.add("active");
          const mode = t.dataset.sort;
          applySort(mode);
        });
      });

      function applySort(mode) {
        if (mode === "cheapest") {
          current = [...sampleFlights].sort((a, b) => a.price - b.price);
        } else if (mode === "fastest") {
          // simplistic: parse hours from duration
          const durToMin = (d) => {
            const m = d.match(/(\d+)h\s*(\d+)?m?/);
            if (!m) return 9999;
            return Number(m[1]) * 60 + (m[2] ? Number(m[2]) : 0);
          };
          current = [...sampleFlights].sort(
            (a, b) => durToMin(a.duration) - durToMin(b.duration)
          );
        } else {
          // recommended: preserve original order or mixed metric
          current = [...sampleFlights];
        }
        renderList(current);
      }

      // filters: simple implementation
      // filters + price range slider wiring
      document.getElementById("priceRange").addEventListener("input", (e) => {
        const max = e.target.value;
        document.getElementById("priceMax").value = max;
        // live update
        applyFilters();
      });
      document
        .getElementById("applyFilters")
        .addEventListener("click", applyFilters);
      document.getElementById("resetFilters").addEventListener("click", () => {
        document
          .querySelectorAll('input[type="checkbox"]')
          .forEach((i) => (i.checked = false));
        document.getElementById("priceMin").value = "";
        document.getElementById("priceMax").value = "";
        document.getElementById("priceRange").value = document.getElementById("priceRange").max;
        document.getElementById("priceMax").value = document.getElementById("priceRange").max;
        current = [...sampleFlights];
        renderList(current);
      });

      // Helper function to parse time from HH:MM format
      function getTimeCategory(timeStr) {
        const hour = parseInt(timeStr.split(':')[0]);
        if (hour >= 5 && hour < 12) return 'morning';
        if (hour >= 12 && hour < 18) return 'afternoon';
        if (hour >= 18 && hour < 24) return 'evening';
        return 'night';
      }

      // Helper function to get duration in minutes
      function getDurationMinutes(durationStr) {
        const match = durationStr.match(/(\d+)h\s*(\d+)?m?/);
        if (!match) return 0;
        return Number(match[1]) * 60 + (match[2] ? Number(match[2]) : 0);
      }

      // Helper function to get duration category
      function getDurationCategory(durationStr) {
        const minutes = getDurationMinutes(durationStr);
        if (minutes < 180) return 'short'; // under 3h
        if (minutes < 360) return 'medium'; // 3-6h
        if (minutes < 720) return 'long'; // 6-12h
        return 'verylong'; // over 12h
      }

      function applyFilters() {
        // Get all filter values
        const stopsChecked = Array.from(
          document.querySelectorAll('input[data-filter="stops"]:checked')
        ).map((i) => i.value);
        
        const airlinesChecked = Array.from(
          document.querySelectorAll('input[data-filter="airline"]:checked')
        ).map((i) => i.value);
        
        const timesChecked = Array.from(
          document.querySelectorAll('input[data-filter="time"]:checked')
        ).map((i) => i.value);
        
        const durationsChecked = Array.from(
          document.querySelectorAll('input[data-filter="duration"]:checked')
        ).map((i) => i.value);

        const min = Number(document.getElementById("priceMin").value) || 0;
        const max = Number(document.getElementById("priceMax").value) || Infinity;
        
        const bookOnSite = document.getElementById("bookOnSite")?.checked;
        const noOvernight = document.getElementById("noOvernight")?.checked;
        const carryOnOnly = document.getElementById("carryOnOnly")?.checked;
        const checkedBag = document.getElementById("checkedBag")?.checked;

        // Filter flights
        current = sampleFlights.filter((f) => {
          // Price filter
          if (!(f.price >= min && f.price <= max)) return false;
          
          // Stops filter
          if (stopsChecked.length) {
            const okStops = stopsChecked.some((s) => {
              if (s === "2+") return f.stops >= 2;
              return Number(s) === f.stops;
            });
            if (!okStops) return false;
          }
          
          // Airline filter
          if (airlinesChecked.length) {
            if (!airlinesChecked.includes(f.airline)) return false;
          }
          
          // Departure time filter
          if (timesChecked.length) {
            const depTimeCategory = getTimeCategory(f.dep);
            if (!timesChecked.includes(depTimeCategory)) return false;
          }
          
          // Duration filter
          if (durationsChecked.length) {
            const durCategory = getDurationCategory(f.duration);
            if (!durationsChecked.includes(durCategory)) return false;
          }
          
          // No overnight flights filter (simple check: if arrival is "next day")
          if (noOvernight) {
            const depHour = parseInt(f.dep.split(':')[0]);
            const arrHour = parseInt(f.arr.split(':')[0]);
            // Simple heuristic: if arrival hour < departure hour, it's overnight
            if (arrHour < depHour && getDurationMinutes(f.duration) > 180) return false;
          }
          
          return true;
        });
        
        renderList(current);
      }

      // init
      applySort("recommended");
      // set default slider max (approx)
      document.getElementById("priceRange").max = Math.max(
        ...sampleFlights.map((f) => f.price),
        1000
      );
      document.getElementById("priceRange").value =
        document.getElementById("priceRange").max;
      document.getElementById("priceMax").value =
        document.getElementById("priceRange").value;

      // Add real-time filtering when checkboxes change
      document.querySelectorAll('.filters input[type="checkbox"]').forEach(checkbox => {
        checkbox.addEventListener('change', applyFilters);
      });

      // Add real-time filtering for price inputs
      document.getElementById("priceMin")?.addEventListener('input', applyFilters);
      document.getElementById("priceMax")?.addEventListener('input', applyFilters);

      // Home/logo helpers:
      // - clicking the Home button / logo already navigates via the anchor href.
      // - to set your logo file programmatically, update #siteLogoImg.src:
      //   document.getElementById('siteLogoImg').src = '../assets/your-logo.png';
      // - Example: if you prefer a JS click handler instead of anchor:
      document
        .getElementById("homeBtn")
        ?.addEventListener("click", function (e) {
          // allow normal anchor navigation; this listener is optional
        });

      // NAV selection: make nav-left items selectable and optionally navigate
      document
        .querySelectorAll(".site-nav .nav-left a.nav-link")
        .forEach((a) => {
          a.addEventListener("click", (e) => {
            e.preventDefault();
            document
              .querySelectorAll(".site-nav .nav-left a.nav-link")
              .forEach((x) => x.classList.remove("active"));
            a.classList.add("active");
            const href = a.getAttribute("href");
            if (href) {
              // navigate to the link
              window.location.href = href;
            }
          });
        });

      // On desktop pointer devices allow hover to temporarily highlight menu
      if (window.matchMedia("(hover: hover) and (pointer: fine)").matches) {
        const navLinks = Array.from(
          document.querySelectorAll(".site-nav .nav-left a.nav-link")
        );
        // do NOT default to the first item — only restore if there's an explicitly persisted active item
        let persisted =
          document.querySelector(".site-nav .nav-left a.nav-link.active") ||
          null;
        navLinks.forEach((a) => {
          a.addEventListener("mouseenter", () => {
            navLinks.forEach((x) => x.classList.remove("active"));
            a.classList.add("active");
          });
          a.addEventListener("mouseleave", () => {
            navLinks.forEach((x) => x.classList.remove("active"));
            // if there is a persisted clicked item, restore it; otherwise leave none active
            if (persisted) persisted.classList.add("active");
          });
          a.addEventListener("click", () => {
            persisted = a;
          });
        });
      }

      // Language and currency selection (persisted)
      function setPref(cls, val) {
        localStorage.setItem(cls, val);
        document.querySelectorAll("." + cls).forEach((el) => {
          el.classList.toggle("active", el.dataset.value === val);
        });
        // update visible currency button when currency changes
        const curBtn = document.querySelector(".cur-btn");
        if (curBtn && cls === "cur") {
          curBtn.textContent = val + " ▾";
        }
        // update visible language button when language changes
        const langBtn = document.querySelector(".lang-btn");
        if (langBtn && cls === "lang") {
          langBtn.textContent = val + " ▾";
        }
      }
      // remove the old .lang/.cur click binding (we now use dropdown items)
      // init from storage (fallbacks)
      setPref("lang", localStorage.getItem("lang") || "EN");
      setPref("cur", localStorage.getItem("cur") || "SAR");

      // language dropdown behavior (touch/click)
      (function () {
        const dropdown = document.querySelector(".lang-dropdown");
        if (!dropdown) return;
        const btn = dropdown.querySelector(".lang-btn");
        const menu = dropdown.querySelector(".lang-menu");
        // toggle on button click (useful on touch)
        btn.addEventListener("click", function (e) {
          e.preventDefault();
          dropdown.classList.toggle("open");
          btn.setAttribute(
            "aria-expanded",
            dropdown.classList.contains("open")
          );
        });
        // select language from menu
        menu.querySelectorAll(".lang-item").forEach((item) => {
          item.addEventListener("click", function (e) {
            const v = this.dataset.value;
            setPref("lang", v);
            // mark active in menu
            menu
              .querySelectorAll(".lang-item")
              .forEach((i) => i.classList.remove("active"));
            this.classList.add("active");
            dropdown.classList.remove("open");
            btn.setAttribute("aria-expanded", "false");
            // optional: load localized resources or update UI strings here
          });
        });
        // close when clicking outside
        document.addEventListener("click", function (ev) {
          if (!dropdown.contains(ev.target)) {
            dropdown.classList.remove("open");
            btn.setAttribute("aria-expanded", "false");
          }
        });
        // initialize active menu item
        const saved = localStorage.getItem("lang") || "EN";
        const activeItem = menu.querySelector(
          `.lang-item[data-value="${saved}"]`
        );
        if (activeItem) activeItem.classList.add("active");
      })();

      // currency dropdown behavior (touch/click)
      (function () {
        const dropdown = document.querySelector(".cur-dropdown");
        if (!dropdown) return;
        const btn = dropdown.querySelector(".cur-btn");
        const menu = dropdown.querySelector(".cur-menu");
        // toggle on button click (useful on touch)
        btn.addEventListener("click", function (e) {
          e.preventDefault();
          dropdown.classList.toggle("open");
          btn.setAttribute(
            "aria-expanded",
            dropdown.classList.contains("open")
          );
        });
        // select currency from menu
        menu.querySelectorAll(".cur-item").forEach((item) => {
          item.addEventListener("click", function (e) {
            const v = this.dataset.value;
            setPref("cur", v);
            // mark active in menu
            menu
              .querySelectorAll(".cur-item")
              .forEach((i) => i.classList.remove("active"));
            this.classList.add("active");
            dropdown.classList.remove("open");
            btn.setAttribute("aria-expanded", "false");
          });
        });
        // close when clicking outside
        document.addEventListener("click", function (ev) {
          if (!dropdown.contains(ev.target)) {
            dropdown.classList.remove("open");
            btn.setAttribute("aria-expanded", "false");
          }
        });
        // initialize active menu item
        const saved = localStorage.getItem("cur") || "SAR";
        const activeItem = menu.querySelector(
          `.cur-item[data-value="${saved}"]`
        );
        if (activeItem) activeItem.classList.add("active");
      })();

      // optional: simple handlers for support/my trips/login
      document.getElementById("supportLink")?.addEventListener("click", (e) => {
        e.preventDefault();
        alert("Open Support (implement link)");
      });
      document.getElementById("myTripsLink")?.addEventListener("click", (e) => {
        e.preventDefault();
        window.location.href = "../../User/my-trips.html";
      });
    </script>

    <!-- ====== Footer ====== -->
    <footer class="site-footer">
      <div class="footer-grid">
        <div class="f-col">
          <div class="f-brand">GoTrip</div>
          <p class="muted">
            Your trusted travel partner for flights, hotels, and buses
            worldwide.
          </p>
        </div>

        <div class="f-col">
          <h4>About GoTrip</h4>
          <ul class="f-links">
            <li><a href="#">Our Story</a></li>
            <li><a href="#">Careers</a></li>
            <li><a href="#">Press</a></li>
            <li><a href="#">Partnerships</a></li>
          </ul>
        </div>

        <div class="f-col">
          <h4>Support</h4>
          <ul class="f-links">
            <li><a href="#">Contact Us</a></li>
            <li><a href="#">FAQs</a></li>
            <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Terms of Service</a></li>
          </ul>
        </div>

        <div class="f-col">
          <h4>Connect</h4>
          <ul class="f-links">
            <li><a href="#">Blog</a></li>
            <li><a href="#">Newsletter</a></li>
            <li><a href="#">Travel Guides</a></li>
            <li><a href="#">Help Center</a></li>
          </ul>
        </div>
      </div>

      <div class="footer-bottom">
        <div class="copy">© 2025 GoTrip. All rights reserved.</div>
        <div class="social">
          <a href="#" aria-label="Facebook">f</a>
          <a href="#" aria-label="Instagram">◎</a>
          <a href="#" aria-label="X">𝕏</a>
          <a href="#" aria-label="LinkedIn">in</a>
        </div>
      </div>
    </footer>
  </body>
</html>
